{"code":"import{NOT_ADMIN_ERR_MSG,UNAUTHED_ERR_MSG}from\"@shared/const\";import{initTRPC,TRPCError}from\"@trpc/server\";import superjson from\"superjson\";const t=initTRPC.context().create({transformer:superjson});const router=t.router;const publicProcedure=t.procedure;const requireUser=t.middleware(async opts=>{const{ctx,next}=opts;if(!ctx.user){throw new TRPCError({code:\"UNAUTHORIZED\",message:UNAUTHED_ERR_MSG})}return next({ctx:{...ctx,user:ctx.user}})});const protectedProcedure=t.procedure.use(requireUser);const adminProcedure=t.procedure.use(t.middleware(async opts=>{const{ctx,next}=opts;if(!ctx.user||ctx.user.role!==\"admin\"){throw new TRPCError({code:\"FORBIDDEN\",message:NOT_ADMIN_ERR_MSG})}return next({ctx:{...ctx,user:ctx.user}})}));export{adminProcedure,protectedProcedure,publicProcedure,router};\n","warnings":[],"map":{"version":3,"mappings":"AAAA,OAAS,kBAAmB,qBAAwB,gBACpD,OAAS,SAAU,cAAiB,eACpC,OAAO,cAAe,YAGtB,MAAM,EAAI,SAAS,QAAqB,EAAE,OAAO,CAC/C,YAAa,SACf,CAAC,EAEM,MAAM,OAAS,EAAE,OACjB,MAAM,gBAAkB,EAAE,UAEjC,MAAM,YAAc,EAAE,WAAW,MAAM,MAAQ,CAC7C,KAAM,CAAE,IAAK,IAAK,EAAI,KAEtB,GAAI,CAAC,IAAI,KAAM,CACb,MAAM,IAAI,UAAU,CAAE,KAAM,eAAgB,QAAS,gBAAiB,CAAC,CACzE,CAEA,OAAO,KAAK,CACV,IAAK,CACH,GAAG,IACH,KAAM,IAAI,IACZ,CACF,CAAC,CACH,CAAC,EAEM,MAAM,mBAAqB,EAAE,UAAU,IAAI,WAAW,EAEtD,MAAM,eAAiB,EAAE,UAAU,IACxC,EAAE,WAAW,MAAM,MAAQ,CACzB,KAAM,CAAE,IAAK,IAAK,EAAI,KAEtB,GAAI,CAAC,IAAI,MAAQ,IAAI,KAAK,OAAS,QAAS,CAC1C,MAAM,IAAI,UAAU,CAAE,KAAM,YAAa,QAAS,iBAAkB,CAAC,CACvE,CAEA,OAAO,KAAK,CACV,IAAK,CACH,GAAG,IACH,KAAM,IAAI,IACZ,CACF,CAAC,CACH,CAAC,CACH","names":[],"ignoreList":[],"sources":["/home/ubuntu/openclaw-concierge/server/_core/trpc.ts"],"sourcesContent":[null]}}